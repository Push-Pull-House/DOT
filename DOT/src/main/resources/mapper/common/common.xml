<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="common">
	
	<resultMap id="imageResultSet" type="images">
		<id column="FILE_NO" property="fileNo"/>
		<result column="FILE_WRITER" property="fileWriter"/>
		<result column="ORIGIN_NAME" property="originName"/>
		<result column="CHANGE_NAME" property="changeName"/>
		<result column="FILE_PATH" property="filePath"/>
		<result column="STATUS" property="status"/>
		<result column="FILE_LEVEL" property="fileLevel"/>
		<result column="FILE_FNO" property="fileFno"/>
	</resultMap>
	
	<resultMap id="alarmResultSet" type="alarm">
		<id column="BOARD_NO" property="alarmNo"/>
		<result column="BOARD_WRITER" property="alarmWriter"/>
		<result column="BOARD_ACCEPTUSER" property="alarmAcceptUser"/>
		<result column="BOARD_CONTENT" property="alarmContent"/>
		<result column="BOARD_TYPE" property="alarmType"/>
	</resultMap>
	
	<select id="selectList" parameterType="string" resultMap="imageResultSet">
		SELECT *
		FROM IMAGE I
		JOIN FEED F ON F.FEED_NO = I.FILE_FNO
		WHERE F.FEED_HASHTAG LIKE '%${keyword}%' AND I.FILE_LEVEL = '2'
	</select> 
	
	
	<insert id="keywordList" parameterType="map">
		INSERT INTO SEARCH 
		VALUES (
			SEQ_search_no.NEXTVAL,
			#{search_writer}, 
			#{search_keyword}
		)		
	</insert>
	
	
	<insert id="insertChatAlarm">
		INSERT INTO BOARD
		VALUES(
			SEQ_BOARD_NO.NEXTVAL,
			#{alarmWriter},
			#{alarmAcceptUser},
			#{alarmContent},
			'C'
		)
	</insert>
	
</mapper>
