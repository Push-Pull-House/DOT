<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="searchMapper">
	
	<resultMap id="imageResultSet" type="image">
		<id column="FILE_NO" property="fileNo"/>
		<result column="FILE_WRITER" property="fileWriter"/>
		<result column="ORIGIN_NAME" property="originName"/>
		<result column="CHANGE_NAME" property="changeName"/>
		<result column="FILE_PATH" property="filePath"/>
		<result column="STATUS" property="status"/>
		<result column="FILE_LEVEL" property="fileLevel"/>
		<result column="FILE_FNO" property="fileFno"/>
	</resultMap>
	
	<select id="selectList" parameterType="string" resultMap="imageResultSet">
		SELECT *
		FROM IMAGE I
		JOIN FEED F ON F.FEED_NO = I.FILE_FNO
		WHERE F.FEED_HASHTAG LIKE '%${keyword}%' AND I.FILE_LEVEL = '2'
	</select> 
	
	<resultMap id="feedResultSet" type="feed">
		<id column="FEED_NO" property="feedNo"/>
		<result column="FEED_WRITER" property="feedWriter"/>
		<result column="LIKE_STATUS" property="likeStatus"/>
		<result column="CHOICE_STATUS" property="choiceStatus"/>
		<result column="LIKE_COUNT" property="likeCount"/>
		<result column="FEED_HASHTAG" property="feedHashtag"/>
		<result column="KEYWORD" property="keyword"/>
	</resultMap>
	
	<insert id="keywordList">
		INSERT INTO SEARCH 
		VALUES (
			SEQ_search_no.NEXTVAL,
			#{search_writer}, 
			#{search_keyword}
		)		
	</insert>
	
	<resultMap id="boardResultMap" type="board">
		<id column="BOARD_NO" property="boardNo"/>
		<result column="BOARD_WRITER" property='boardWriter'/>
		<result column="BOARD_TITLE" property="boardTitle"/>
		<result column="BOARD_CONTENT" property="boardContent"/>
		<result column="CREATE_DATE" property="createDate"/>
		<result column="STATUS" property="status"/>
	</resultMap> 
	
	<select id="alarmList" parameterType="string" resultMap="boardResultMap">
		SELECT USER_ID, BOARD_TITLE, BOARD_CONTENT
		FROM BOARD B
		JOIN MEMBER M ON B.BOARD_WRITER = M.USER_NO
		WHERE B.CREATE_DATE = 'SYSDATE' OR B.STATUS ='Y'
	</select>
	
	<!-- <select id="convertAndSend" parameterType="string" resultMap="boardResultMap">
		SELECT
		FROM 
	</select> -->
	
</mapper>
